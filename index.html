<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>注文フォーム</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      padding: 2rem;
      margin: auto;
      max-width: 420px;
      background-color: #fafafa;
      color: #333;
    }
    h1 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }
    #blockContainer {
      display: flex;
      align-items: flex-end;
      gap: 6px;
      margin-bottom: 1.5rem;
      border-bottom: 1px solid #ccc;
      padding-bottom: 1rem;
      justify-content: flex-start;
      height: 160px;
      overflow: hidden;
      flex-wrap: wrap;
    }
    .stack {
      display: flex;
      flex-direction: column-reverse;
      align-items: center;
      gap: 2px;
    }
    .block-svg {
      height: auto;
    }
    .block20 { width: 20px; }
    .block30 { width: 30px; }
    .block40 { width: 40px; }
    .block50 { width: 50px; }
    .block60 { width: 60px; }

    .kid-image {
      height: 80px;
      margin-right: 6px;
    }
    .block-row {
      margin-bottom: 1rem;
    }
    .block-row label {
      display: block;
      font-weight: 600;
      margin-bottom: 0.3rem;
    }
    select, input {
      font-size: 1rem;
      padding: 0.4rem;
      width: 100%;
      margin-bottom: 0.4rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .color-list {
      margin-top: 0.5rem;
    }
    .total {
      text-align: right;
      font-weight: bold;
      font-size: 1.2rem;
      margin-top: 2rem;
    }
    button {
      width: 100%;
      padding: 0.75rem;
      font-size: 1rem;
      background-color: #007aff;
      color: white;
      border: none;
      border-radius: 8px;
      margin-top: 1rem;
    }
    @media (max-width: 480px) {
      #blockContainer {
        flex-direction: column-reverse;
        align-items: center;
        height: auto;
      }
      .stack {
        flex-direction: row;
        gap: 4px;
      }
    }
  </style>
</head>
<body>
  <h1>BIG tumi-isi 注文</h1>
  <div id="blockContainer">
    <img src="kids.svg" alt="Kid size" class="kid-image" />
    <div class="stack" id="stackA"></div>
    <div class="stack" id="stackB"></div>
    <div class="stack" id="stackC"></div>
  </div>

  <div id="formArea"></div>
  <div class="total">合計金額：<span id="totalPrice">0</span> 円</div>
  <button onclick="submitOrder()">注文内容を送信</button>

  <script>
    const prices = {
      block20: 55000,
      block30: 80000,
      block40: 140000,
      block50: 200000,
      block60: 250000
    };

    const svgPaths = {
      block20: "block-20cm.svg",
      block30: "block-30cm.svg",
      block40: "block-40cm.svg",
      block50: "block-50cm.svg",
      block60: "block-60cm.svg"
    };

    const colorList = [
  { name: "01 LEMON", code: "#e6e137" },
  { name: "02 YELLOW", code: "#f5a623" },
  { name: "03 MUSTARD", code: "#d68f29" },
  { name: "04 ORANGE", code: "#f26522" },
  { name: "05 RED", code: "#cc3333" },
  { name: "06 PINK", code: "#e87ca2" },
  { name: "07 VIOLET", code: "#a55c9a" },
  { name: "08 PURPLE", code: "#8463a3" },
  { name: "09 LIGHT BLUE", code: "#2c9ab7" },
  { name: "10 INDIGO", code: "#1e4f91" },
  { name: "11 BLUE", code: "#005bab" },
  { name: "12 NAVY", code: "#003468" },
  { name: "13 MINT BLUE", code: "#71b7ba" },
  { name: "14 PISTACHIO", code: "#c5e2c2" },
  { name: "15 LIGHT GREEN", code: "#b3d465" },
  { name: "16 GRASS GREEN", code: "#729e3a" },
  { name: "17 DARK GREEN", code: "#4f5e2d" },
  { name: "18 BEIGE", code: "#c9b29c" },
  { name: "19 PALE BROWN", code: "#a67c52" },
  { name: "20 BROWN", code: "#6b4e2e" },
  { name: "21 CAMEL", code: "#b37333" },
  { name: "22 MID GREY", code: "#999999" },
  { name: "23 DARK GREY", code: "#666666" },
  { name: "24 PEARL WHITE", code: "#e6ddd2" },
  { name: "25 OFF WHITE", code: "#f2f0eb" },
  { name: "26 WHITE", code: "#ffffff" },
  { name: "27 BLACK", code: "#000000" },
  { name: "28 AQUA", code: "#90d7d6" },
  { name: "29 SKY", code: "#8dbdd8" },
  { name: "30 CANDY PINK", code: "#f3a9b5" },
  { name: "31 ORANGE RED", code: "#e03c31" },
  { name: "32 LIME", code: "#a6ce39" }
];

    const formArea = document.getElementById("formArea");
    const stacks = [
      document.getElementById("stackA"),
      document.getElementById("stackB"),
      document.getElementById("stackC")
    ];

    [20, 30, 40, 50, 60].forEach(size => {
      const id = `block${size}`;
      const blockRow = document.createElement('div');
      blockRow.className = 'block-row';
      blockRow.innerHTML = `
        <label for="${id}">${size}cm</label>
        <select id="${id}" data-size="${size}">
          <option value="0">0 個</option>
          <option value="1">1 個</option>
          <option value="2">2 個</option>
          <option value="3">3 個</option>
          <option value="4">4 個</option>
          <option value="5">5 個</option>
        </select>
        <div class="color-list" id="colorWrap${size}"></div>
      `;
      formArea.appendChild(blockRow);
    });

    function createColorSelect(name) {
      const select = document.createElement('select');
      select.name = name;
      colorList.forEach((color, index) => {
        const opt = document.createElement('option');
        opt.value = color.code;
        opt.textContent = color.name;
        select.appendChild(opt);
      });
      return select;
    }

    function updateColorSelectors(size) {
      const count = parseInt(document.getElementById(`block${size}`).value);
      const wrap = document.getElementById(`colorWrap${size}`);
      wrap.innerHTML = '';
      for (let i = 0; i < count; i++) {
        const sel = createColorSelect(`color${size}_${i}`);
        wrap.appendChild(sel);
      }
    }

    function updateBlocks() {
      stacks.forEach(stack => stack.innerHTML = "");
      let stackIndex = 0;
      [20, 30, 40, 50, 60].forEach(size => {
        const count = parseInt(document.getElementById(`block${size}`).value) || 0;
        for (let i = 0; i < count; i++) {
          const color = document.querySelector(`select[name=color${size}_${i}]`)?.value || "#ccc";
          const img = document.createElement('img');
          img.classList.add('block-svg', `block${size}`);
          img.style.backgroundColor = color;
          img.style.webkitMaskImage = `url(${svgPaths[`block${size}`]})`;
          img.style.maskImage = `url(${svgPaths[`block${size}`]})`;
          img.style.webkitMaskRepeat = "no-repeat";
          img.style.maskRepeat = "no-repeat";
          img.style.webkitMaskSize = "contain";
          img.style.maskSize = "contain";
          img.style.backgroundRepeat = "no-repeat";
          img.style.backgroundColor = color;
          img.style.webkitMaskImage = `url(${img.src})`;
          img.style.maskImage = `url(${img.src})`;
          img.style.webkitMaskRepeat = "no-repeat";
          img.style.maskRepeat = "no-repeat";
          img.style.webkitMaskSize = "contain";
          img.style.maskSize = "contain";
          img.style.backgroundRepeat = "no-repeat";
          const colorName = document.querySelector(`select[name=color${size}_${i}]`)?.selectedOptions[0]?.textContent;
          img.alt = colorName;
          img.title = colorName;
          img.src = svgPaths[`block${size}`];
          img.title = colorName;
          stacks[stackIndex % stacks.length].appendChild(img);
          stackIndex++;
        }
      });
    }

    function calculateTotal() {
      let total = 0;
      [20, 30, 40, 50, 60].forEach(size => {
        const count = parseInt(document.getElementById(`block${size}`).value) || 0;
        total += count * prices[`block${size}`];
      });
      document.getElementById('totalPrice').textContent = total.toLocaleString();
    }

    function submitOrder() {
      const order = {};
      [20, 30, 40, 50, 60].forEach(size => {
        const count = parseInt(document.getElementById(`block${size}`).value);
        if (count > 0) {
          const colors = [];
          for (let i = 0; i < count; i++) {
            const color = document.querySelector(`select[name=color${size}_${i}]`).value;
            colors.push(color);
          }
          order[size + "cm"] = colors;
        }
      });
      alert("送信されました\n\n" + JSON.stringify(order, null, 2));
    }

    [20, 30, 40, 50, 60].forEach(size => {
      const select = document.getElementById(`block${size}`);
      select.addEventListener('change', () => {
        updateColorSelectors(size);
        updateBlocks();
        calculateTotal();
      });
    });
  </script>
</body>
</html>
