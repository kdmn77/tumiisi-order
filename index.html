<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BIG tumi-isi 注文フォーム</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      padding: 2rem;
      margin: auto;
      max-width: 420px;
      background:#fafafa;
      color:#333;
    }
    h1{font-size:1.6rem;margin-bottom:1rem;}

    /* ─── ビジュアル領域 ─── */
    #blockContainer{
      display:flex;align-items:flex-end;gap:6px;margin-bottom:1.5rem;
      border-bottom:1px solid #ccc;padding-bottom:1rem;
      height:160px;overflow:hidden;flex-wrap:wrap;
    }
    .kid-image{height:80px;margin-right:6px;flex:0 0 auto;}
    .stack{display:flex;flex-direction:column-reverse;align-items:center;gap:2px;flex:0 0 auto;}
    .block-svg{height:auto;}
    .block20{width:20px}.block30{width:30px}.block40{width:40px}.block50{width:50px}.block60{width:60px}

    /* ─── 入力UI ─── */
    .block-row{margin-bottom:1rem;}
    .block-row label{display:block;font-weight:600;margin-bottom:.3rem;}
    select,input{width:100%;font-size:1rem;padding:.45rem;border:1px solid #ccc;border-radius:6px;margin-bottom:.4rem;}
    .color-list{margin-top:.4rem;}

    .total{margin-top:2rem;font-weight:bold;text-align:right;font-size:1.2rem;}
    button{width:100%;padding:.75rem;font-size:1rem;background:#007aff;color:#fff;border:none;border-radius:8px;margin-top:1rem;}

    @media(max-width:480px){
      #blockContainer{flex-direction:column-reverse;align-items:center;height:auto;}
      .stack{flex-direction:row;gap:4px;}
    }
  </style>
</head>
<body>
  <h1>BIG tumi-isi 注文</h1>
  <!-- ビジュアル -->
  <div id="blockContainer">
    <img src="kids.svg" alt="kid" class="kid-image" />
    <div class="stack" id="stackA"></div>
    <div class="stack" id="stackB"></div>
    <div class="stack" id="stackC"></div>
  </div>

  <!-- フォーム生成領域 -->
  <div id="formArea"></div>
  <div class="total">合計金額：<span id="totalPrice">0</span> 円</div>
  <button onclick="submitOrder()">注文内容を送信</button>

<script>
/***** 価格・画像パス *****/
const prices = {block20:55000,block30:80000,block40:140000,block50:200000,block60:250000};
const svgPaths = {
  block20:"block-20cm.svg",block30:"block-30cm.svg",block40:"block-40cm.svg",block50:"block-50cm.svg",block60:"block-60cm.svg"
};
/***** 色リスト（32色） *****/
const colorList=[
  {name:"01 LEMON",code:"#e6e137"}, {name:"02 YELLOW",code:"#f5a623"}, {name:"03 MUSTARD",code:"#d68f29"},
  {name:"04 ORANGE",code:"#f26522"}, {name:"05 RED",code:"#cc3333"}, {name:"06 PINK",code:"#e87ca2"},
  {name:"07 VIOLET",code:"#a55c9a"}, {name:"08 PURPLE",code:"#8463a3"}, {name:"09 LIGHT BLUE",code:"#2c9ab7"},
  {name:"10 INDIGO",code:"#1e4f91"}, {name:"11 BLUE",code:"#005bab"}, {name:"12 NAVY",code:"#003468"},
  {name:"13 MINT BLUE",code:"#71b7ba"}, {name:"14 PISTACHIO",code:"#c5e2c2"}, {name:"15 LIGHT GREEN",code:"#b3d465"},
  {name:"16 GRASS GREEN",code:"#729e3a"}, {name:"17 DARK GREEN",code:"#4f5e2d"}, {name:"18 BEIGE",code:"#c9b29c"},
  {name:"19 PALE BROWN",code:"#a67c52"}, {name:"20 BROWN",code:"#6b4e2e"}, {name:"21 CAMEL",code:"#b37333"},
  {name:"22 MID GREY",code:"#999"}, {name:"23 DARK GREY",code:"#666"}, {name:"24 PEARL WHITE",code:"#e6ddd2"},
  {name:"25 OFF WHITE",code:"#f2f0eb"}, {name:"26 WHITE",code:"#ffffff"}, {name:"27 BLACK",code:"#000"},
  {name:"28 AQUA",code:"#90d7d6"}, {name:"29 SKY",code:"#8dbdd8"}, {name:"30 CANDY PINK",code:"#f3a9b5"},
  {name:"31 ORANGE RED",code:"#e03c31"}, {name:"32 LIME",code:"#a6ce39"}
];

const formArea = document.getElementById("formArea");
const stacks   = [document.getElementById("stackA"),document.getElementById("stackB"),document.getElementById("stackC")];

/***** サイズごとに入力UI生成 *****/
[20,30,40,50,60].forEach(size=>{
  const row=document.createElement('div');row.className='block-row';
  row.innerHTML=`<label>${size}cm</label>
    <select id="block${size}">${[0,1,2,3,4,5].map(n=>`<option value="${n}">${n} 個</option>`).join('')}</select>
    <div id="colorWrap${size}" class="color-list"></div>`;
  formArea.appendChild(row);
});

function createColorSelect(name){
  const sel=document.createElement('select');sel.name=name;
  colorList.forEach(c=>{
    const opt=document.createElement('option');opt.value=c.code;opt.textContent=c.name;sel.appendChild(opt);
  });
  return sel;
}

function updateColorSelectors(size){
  const count=parseInt(document.getElementById(`block${size}`).value);
  const wrap=document.getElementById(`colorWrap${size}`);wrap.innerHTML='';
  for(let i=0;i<count;i++){wrap.appendChild(createColorSelect(`color${size}_${i}`));}
}

function updateBlocks(){
  /* 下から大→小になるようサイズを降順で処理 */
  const sizeOrder=[60,50,40,30,20];
  stacks.forEach(s=>s.innerHTML='');
  let stackIdx=0;
  sizeOrder.forEach(size=>{
    const cnt=parseInt(document.getElementById(`block${size}`).value)||0;
    for(let i=0;i<cnt;i++){
      const sel=document.querySelector(`select[name=color${size}_${i}]`);
      const colorCode=sel?sel.value:'#ccc';
      const colorName=sel?sel.selectedOptions[0].textContent:'';
      const img=document.createElement('img');
      img.classList.add('block-svg',`block${size}`);
      img.alt=colorName;img.title=colorName;img.style.visibility='hidden';
      img.onload=()=>{
        img.style.visibility='visible';
        const m=`url(${img.src})`;
        img.style.mask=`${m} center/contain no-repeat`;
        img.style.webkitMask=`${m} center/contain no-repeat`;
        img.style.backgroundColor=colorCode;
        img.style.backgroundRepeat='no-repeat';
      };
      img.src=svgPaths[`block${size}`];
      stacks[stackIdx%stacks.length].appendChild(img);
      stackIdx++;
    }
  });
}
  });
}

function calcTotal(){
  let t=0;[20,30,40,50,60].forEach(sz=>{t+= (parseInt(document.getElementById(`block${sz}`).value)||0)*prices[`block${sz}`];});
  document.getElementById('totalPrice').textContent=t.toLocaleString();
}

function submitOrder(){
  const order={};
  [20,30,40,50,60].forEach(sz=>{
    const cnt=parseInt(document.getElementById(`block${sz}`).value)||0;
    if(cnt){order[`${sz}cm`]=[...document.querySelectorAll(`select[name^=color${sz}_]`)].map(s=>s.value);} });
  alert('送信内容\n'+JSON.stringify(order,null,2));
}

/* イベントバインド */
[20,30,40,50,60].forEach(sz=>{
  document.getElementById(`block${sz}`).addEventListener('change',()=>{updateColorSelectors(sz);updateBlocks();calcTotal();});
});
</script>
</body>
</html>
