<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BIG tumi‑isi 注文</title>
<style>
 body{-webkit-font-smoothing:antialiased;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;margin:auto;max-width:440px;padding:24px;background:#fafafa;color:#333}
 h1{font-size:1.7rem;font-weight:700;margin:0 0 20px}
 #blockContainer{display:flex;align-items:flex-end;gap:8px;border-bottom:1px solid #d0d0d0;padding-bottom:20px;margin-bottom:24px;flex-wrap:wrap;min-height:200px}
 .kid-image{height:120px;margin-right:8px;flex:0 0 auto}
 .stack{display:flex;flex-direction:column-reverse;align-items:center;gap:6px}
 .block-row{margin-bottom:20px}
 .block-row label{font-weight:600;margin-bottom:6px;display:block}
 select{width:100%;font-size:1rem;padding:.55rem;border:1px solid #ccc;border-radius:8px;margin-bottom:8px;box-sizing:border-box}
 .total{font-size:1.25rem;font-weight:700;text-align:right;margin-top:32px}
 button{width:100%;padding:14px;font-size:1rem;background:#007aff;color:#fff;border:none;border-radius:10px;margin-top:20px}
 @media(max-width:480px){#blockContainer{flex-direction:column-reverse;align-items:center}.stack{flex-direction:row}}
</style>
</head>
<body>
<h1>BIG tumi‑isi 注文</h1>

<div id="blockContainer">
  <img src="kids.svg" alt="kid" class="kid-image" />
  <div class="stack" id="stackA"></div>
  <div class="stack" id="stackB"></div>
  <div class="stack" id="stackC"></div>
</div>

<div id="formArea"></div>
<div class="total">合計金額：<span id="totalPrice">0</span> 円</div>
<button onclick="submitOrder()">注文内容を送信</button>

<script>
/***** 設定 *****/
const sizes=[20,30,40,50,60];
const kidPx=120, kidCm=100, pxPerCm=kidPx/kidCm*0.9; // 60cm≈65px
const prices={block20:55000,block30:80000,block40:140000,block50:200000,block60:250000};
const svgPaths={
  block20:'block-20cm.svg',block30:'block-30cm.svg',block40:'block-40cm.svg',block50:'block-50cm.svg',block60:'block-60cm.svg'
};
const colorList=[
 {n:'01 LEMON',c:'#e6e137'},{n:'02 YELLOW',c:'#f5a623'},{n:'03 MUSTARD',c:'#d68f29'},{n:'04 ORANGE',c:'#f26522'},{n:'05 RED',c:'#cc3333'},
 {n:'06 PINK',c:'#e87ca2'},{n:'07 VIOLET',c:'#a55c9a'},{n:'08 PURPLE',c:'#8463a3'},{n:'09 LIGHT BLUE',c:'#2c9ab7'},{n:'10 INDIGO',c:'#1e4f91'},
 {n:'11 BLUE',c:'#005bab'},{n:'12 NAVY',c:'#003468'},{n:'13 MINT BLUE',c:'#71b7ba'},{n:'14 PISTACHIO',c:'#c5e2c2'},{n:'15 LIGHT GREEN',c:'#b3d465'},
 {n:'16 GRASS GREEN',c:'#729e3a'},{n:'17 DARK GREEN',c:'#4f5e2d'},{n:'18 BEIGE',c:'#c9b29c'},{n:'19 PALE BROWN',c:'#a67c52'},{n:'20 BROWN',c:'#6b4e2e'},
 {n:'21 CAMEL',c:'#b37333'},{n:'22 MID GREY',c:'#999'},{n:'23 DARK GREY',c:'#666'},{n:'24 PEARL WHITE',c:'#e6ddd2'},{n:'25 OFF WHITE',c:'#f2f0eb'},
 {n:'26 WHITE',c:'#ffffff'},{n:'27 BLACK',c:'#000'},{n:'28 AQUA',c:'#90d7d6'},{n:'29 SKY',c:'#8dbdd8'},{n:'30 CANDY PINK',c:'#f3a9b5'},
 {n:'31 ORANGE RED',c:'#e03c31'},{n:'32 LIME',c:'#a6ce39'}
];
const stacks=[...document.querySelectorAll('.stack')];
const formArea=document.getElementById('formArea');
/***** UI 生成 *****/
sizes.forEach(sz=>{
  const row=document.createElement('div');row.className='block-row';
  row.innerHTML=`<label>${sz}cm</label>
    <select id="block${sz}">${[0,1,2,3,4,5].map(n=>`<option value='${n}'>${n} 個</option>`).join('')}</select>
    <div id="colorWrap${sz}"></div>`;
  formArea.appendChild(row);
});
function createColorSel(name){
  const sel=document.createElement('select');sel.name=name;
  colorList.forEach(c=>sel.add(new Option(c.n,c.c)));
  sel.addEventListener('change',updateBlocks);
  return sel;
}
function refreshColorSel(sz){
  const cnt=+document.getElementById(`block${sz}`).value;
  const wrap=document.getElementById(`colorWrap${sz}`);
  wrap.replaceChildren(...Array.from({length:cnt},(_,i)=>createColorSel(`color${sz}_${i}`)));
}
/***** 描画 *****/
function updateBlocks(){
  stacks.forEach(s=>s.innerHTML='');
  let idx=0;
  [...sizes].reverse().forEach(sz=>{
    const cnt=+document.getElementById(`block${sz}`).value||0;
    const px = sz*pxPerCm;
    for(let i=0;i<cnt;i++){
      const sel=document.querySelector(`select[name=color${sz}_${i}]`);
      const color=sel?sel.value:'#ccc';
      const title=sel?sel.selectedOptions[0].textContent:'';

      // 包み div
      const wrapper=document.createElement('div');
      wrapper.style.position='relative';
      wrapper.style.width=px+'px';
      wrapper.style.height=px+'px';

      // 塗りつぶし層 (mask)
      const fill=document.createElement('div');
      fill.style.cssText=`width:100%;height:100%;background:${color};mask:url(${svgPaths[`block${sz}`]}) center/contain no-repeat;-webkit-mask:url(${svgPaths[`block${sz}`]}) center/contain no-repeat;`;
      wrapper.appendChild(fill);

      // 黒線層 (透過 PNG/SVG をそのまま重ねる)
      const line=document.createElement('img');
      line.src=svgPaths[`block${sz}`];
      line.style.cssText='position:absolute;inset:0;width:100%;height:100%;object-fit:contain;pointer-events:none;';
      line.alt=title; wrapper.title=title;
      wrapper.appendChild(line);

      stacks[idx++%stacks.length].appendChild(wrapper);
    }
  });
  calcTotal();
}
}
/***** 合計 *****/
function calcTotal(){
  const total=sizes.reduce((sum,sz)=>sum+(+document.getElementById(`block${sz}`).value||0)*prices[`block${sz}`],0);
  document.getElementById('totalPrice').textContent=total.toLocaleString();
}
/***** 送信ダイアログ *****/
function submitOrder(){
  const data={};sizes.forEach(sz=>{const cnt=+document.getElementById(`block${sz}`).value||0;if(cnt){data[`${sz}cm`]=[...document.querySelectorAll(`select[name^=color${sz}_]`)].map(o=>o.textContent);}});
  alert('送信内容\n'+JSON.stringify(data,null,2));
}
/***** イベント *****/
sizes.forEach(sz=>{
  document.getElementById(`block
